/**
 * qantic.angularjs.stylemodel
 * @version v0.0.1 - 2014-01-16
 * @link https://github.com/ntrp/qantic-angularjs-stylemodel
 * @author Ivan Greguric Ortolan <ivan.g.ortolan@gmail.com>
 * @license LGPL License, http://www.opensource.org/licenses/LGPL
 */
"use strict";angular.module("qantic.angularjs.stylemodel",[]).provider("StyleModelContainer",function(){this.$get=function(){var a={minx:0,maxx:0,miny:0,maxy:0,pivotx:0,pivoty:0,styleObject:{},addStyle:function(a,b){this.styleObject[a]={style:b.call(null,this.pivotx,this.pivoty),modelFn:b}},delStyle:function(a){this.styleObject.splice(a,1)},transform:function(a,b){this.pivotx=a=Math.min(Math.max(a,this.minx),this.maxx),this.pivoty=b=Math.min(Math.max(b,this.miny),this.maxy),angular.forEach(this.styleObject,function(c){c.style=c.modelFn.call(null,a,b)})}},b={};return{add:function(c,d,e,f,g,h,i){var j=angular.copy(a);angular.extend(j,{minx:d,maxx:e,miny:f,maxy:g,pivotx:h,pivoty:i}),b[c]=j},del:function(a){delete b[a]},get:function(a){return b[a]}}}}).directive("transformMultiStyle",["$document","StyleModelContainer",function(a,b){return{restrict:"A",scope:!0,link:function(c,d,e){function f(a){i=a.pageX-k,j=a.pageY-l,c.$apply(h.transform(i,j))}function g(){a.unbind("mousemove",f),a.unbind("mouseup",g)}var h=b.get(e.styleName),i=0,j=0,k=0,l=0;d.bind("mousedown",function(){0===event.button&&(event.preventDefault(),a.unbind("mousemove",f),a.unbind("mouseup",g),i=h.pivotx,j=h.pivoty,k=event.pageX-i,l=event.pageY-j,a.bind("mousemove",f),a.bind("mouseup",g))})}}}]);